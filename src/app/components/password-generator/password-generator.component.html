<div class="password-generator">
  <!-- Botão compacto para geração rápida -->
  <p-button 
    icon="pi pi-key" 
    styleClass="p-button-text p-button-plain"
    pTooltip="Gerar Senha" 
    tooltipPosition="top"
    (onClick)="quickGenerate()">
  </p-button>

  <!-- Botão para abrir o gerador avançado -->
  <p-button 
    icon="pi pi-sliders-h" 
    styleClass="p-button-text p-button-plain ml-1"
    pTooltip="Gerador Avançado" 
    tooltipPosition="top"
    (onClick)="showGenerator = true">
  </p-button>

  <!-- Diálogo do gerador avançado -->
  <p-dialog 
    [(visible)]="showGenerator" 
    header="Gerador de Senhas" 
    [style]="{width: '500px'}"
    [modal]="true">
    
    <div class="p-fluid">
      <!-- Senha Gerada -->
      <div class="field mb-4">
        <label class="font-bold block mb-2">Senha Gerada</label>
        <div class="flex gap-2">
          <input 
            type="text" 
            pInputText 
            [(ngModel)]="generatedPassword" 
            class="w-full" 
            readonly>
          <p-button 
            icon="pi pi-copy" 
            (onClick)="copyToClipboard()"
            [disabled]="!generatedPassword">
          </p-button>
        </div>
        
        <!-- Indicador de Força -->
        <div *ngIf="generatedPassword" class="mt-2">
          <div class="flex justify-content-between align-items-center">
            <span class="text-sm">Força: </span>
            <span 
              class="font-bold text-sm" 
              [style.color]="passwordStrength.color">
              {{ passwordStrength.label }}
            </span>
          </div>
          <p-progressBar 
            [value]="(passwordStrength.score / 5) * 100" 
            [style]="{'height': '4px'}"
            [styleClass]="'mt-1'">
          </p-progressBar>
        </div>
      </div>

      <!-- Configurações Rápidas -->
      <div class="field mb-4">
        <label class="font-bold block mb-2">Configurações Rápidas</label>
        <div class="flex gap-2">
          <p-button 
            label="Forte" 
            styleClass="p-button-outlined p-button-sm"
            (onClick)="usePreset('strong')">
          </p-button>
          <p-button 
            label="Muito Forte" 
            styleClass="p-button-outlined p-button-sm"
            (onClick)="usePreset('veryStrong')">
          </p-button>
          <p-button 
            label="Memorável" 
            styleClass="p-button-outlined p-button-sm"
            (onClick)="usePreset('memorable')">
          </p-button>
        </div>
      </div>

      <!-- Opções Avançadas -->
      <div class="field mb-3">
        <label class="font-bold block mb-2">Comprimento: {{ options.length }}</label>
        <p-slider 
          [(ngModel)]="options.length"
          [min]="8" 
          [max]="32"
          (onSlideEnd)="onOptionsChange()">
        </p-slider>
      </div>

      <div class="grid">
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.includeUppercase" 
            label="Letras Maiúsculas"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.includeLowercase" 
            label="Letras Minúsculas"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.includeNumbers" 
            label="Números"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.includeSymbols" 
            label="Símbolos"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.excludeSimilar" 
            label="Excluir Similares"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
        <div class="col-6">
          <p-checkbox 
            [(ngModel)]="options.excludeAmbiguous" 
            label="Excluir Ambíguos"
            (onChange)="onOptionsChange()">
          </p-checkbox>
        </div>
      </div>
    </div>

    <ng-template pTemplate="footer">
      <p-button 
        label="Cancelar" 
        icon="pi pi-times" 
        styleClass="p-button-text"
        (onClick)="showGenerator = false">
      </p-button>
      <p-button 
        label="Gerar" 
        icon="pi pi-sync" 
        styleClass="p-button-outlined"
        (onClick)="generatePassword()">
      </p-button>
      <p-button 
        label="Usar Senha" 
        icon="pi pi-check" 
        (onClick)="usePassword()"
        [disabled]="!generatedPassword">
      </p-button>
    </ng-template>
  </p-dialog>
</div>